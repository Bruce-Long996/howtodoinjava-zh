# Spring Batch + Quartz + H2 Jdbcjobstore 示例

> 原文： [https://howtodoinjava.com/spring-batch/quartz-h2-jdbcjobstore-example/](https://howtodoinjava.com/spring-batch/quartz-h2-jdbcjobstore-example/)

学习使用 Quartz 调度程序和 Quartz 用于记录作业和触发信息的持久性数据库存储记录来执行**多个 Spring Batch 作业**。 我在启用 Web 控制台的情况下使用`H2`数据库来查看数据库表中的数据。 您可以根据需要选择数据库。

## 项目结构

#### 目标

在本教程中，我们将创建一个 Spring 应用程序并执行以下任务。

1.  创建 2 个 Spring Batch 作业。 每个作业都有多个步骤。
2.  创建 Quartz 作业和触发器，它们将运行在步骤 1 中创建的 SpringBatch。
3.  Quartz 作业和触发器将存储在文件系统中的持久性 H2 数据库中。
4.  通过 **H2 控制台**验证存储在 DB 中的触发信息。
5.  使用`LoggingTriggerHistoryPlugin`在日志中记录完整的触发器历史记录。

#### 项目结构

![Project Structure](img/829fa7c45324bddf48aa62c24ae674d3.jpg)

Project Structure

[](maven)

## Maven 依赖

我们需要具有以下依赖性才能运行此项目。

`pom.xml`

[PRE0]

## 配置 Spring Batch 作业和任务

创建一些`Tasklets`和批处理作业以执行。

`MyTaskOne.java and MyTaskTwo.java`

[PRE1]

`BatchConfig.java`

[PRE2]

`application.properties`

[PRE3]

## 配置 Quartz 作业和触发器

现在创建 Quartz 作业，它将运行 SpringBatch。

`CustomQuartzJob.java`

[PRE4]

`QuartzConfig.java`

[PRE5]

`quartz.properties`

[PRE6]

## 配置 H2 数据库

使用`quartz.properties`文件中的属性将 quartz 配置为使用 H2 数据库。

`quartz.properties`

[PRE7]

Quartz 不会自动在数据库中创建必要的表，您需要在应用程序启动时创建它们。 我已经使用了上面的`org.quartz.dataSource.myDS.URL`属性。 模式查询位于`schema.sql`文件中。

`schema.sql`

[PRE8]

## 运行演示

#### 配置日志记录并启动应用程序

为了格式化日志语句，我创建了自定义`logback.xml`。

`logback.xml`

[PRE9]

作为 Spring 启动应用程序启动该应用程序。

`App.java`

[PRE10]

#### 验证作业执行

在服务器控制台中验证正在执行的 Spring Batch 作业。

`Console`

[PRE11]

#### 验证 H2 控制台

使用浏览器 URL 访问 H2 控制台：`http://localhost:8080/console/`

![H2 Console](img/02405e7b8e4a46d943b13e82ce08aeef.jpg)

H2 Console

将我的问题放在评论部分。

学习愉快！