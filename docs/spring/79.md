# Spring Boot – 带有 JAX-RS 注解的基于角色的安全性

> 原文： [https://howtodoinjava.com/spring-boot/role-based-security-jaxrs-annotations/](https://howtodoinjava.com/spring-boot/role-based-security-jaxrs-annotations/)

学习使用 Spring Boot 和 [Jersey](//howtodoinjava.com/jersey-jax-rs-tutorials/) 框架创建 JAX-RS 2.0 [REST API](http://restfulapi.net/) ，并使用 JAX-RS 注解添加**基于角色的安全性**，例如 `@PermitAll`，`@RolesAllowed`或`@DenyAll`。

## 项目结构

在本教程中创建的应用程序的项目结构如下：

![Spring Boot JAX-RS Security Demo - Project Structure](img/6e882e380f77036032c153c1fab69218.jpg)

Spring Boot JAX-RS 安全性示例 – 项目结构

## 创建 REST API

1.  #### 创建 Spring Boot 项目

    转到 [Spring 初始化器](https://start.spring.io/)门户，并创建具有 **Jersey（JAX-RS）**依赖项的 spring boot 应用程序。

    ![Select Jersey in Spring Boot Initializr](img/ed125bf607ef36429085f73a1a098f02.jpg)

    在 Spring 初始化器中选择 Jersey

2.  #### 在 Eclipse 中导入

    将项目生成为 zip 文件。 将其解压缩到计算机中的某个位置。 将项目作为“现有 maven 应用程序”导入 eclipse。

3.  #### 检查 Maven 依赖项

    检查 Maven 文件中是否具有**依赖项**。

    [PRE0]

4.  #### 创建 REST API

    现在创建一些 JAX-RS 资源，我们将进入测试阶段。 我创建了`UserResource`类。

    `UserResource.java`

    [PRE1]

    `Users.java`

    [PRE2]

    `User.java`

    [PRE3]

5.  #### 配置 Jersey

    现在我们有了一个 JAX-RS 资源，我们想从包含 Jersey 依赖项的 spring boot 应用程序中访问它。 让我们将此资源注册为 Jersey 资源。

    [PRE4]

    *   查看`@Component`注解。 它可以在 Spring Boot 自动扫描源文件夹中的 java 类时注册此类。
    *   `ResourceConfig`提供高级功能以简化 JAX-RS 组件的注册。
    *   `SecurityFilter`类是实际的身份验证详细信息处理器，我们将在本教程的后面部分看到。

    用`SpringBootServletInitializer`扩展 spring boot 应用程序。

    [PRE5]

## 使用 JAX-RS 注解的安全 REST API

现在，当我们的 API 准备就绪时，我们将开始保护它们。 让我们根据 **JAX-RS 注解**对其进行注解，具体取决于它们的期望访问级别和允许访问它们的用户角色。

[PRE6]

您可以在上面突出显示的行中查看与安全相关的 JAX-RS 注解。

## 使用 JAX-RS `ContainerRequestFilter`编写安全过滤器

现在是时候编写我们的安全过滤器了，该过滤器将检查传入的请求，获取授权信息（在此示例中为基本认证），然后匹配用户名和密码，最后将通过其角色来验证用户的访问级别。 如果一切都匹配，则将访问 API，否则用户将获得拒绝访问响应。

[PRE7]

## 示例

将项目作为 Spring 启动应用程序运行。 现在测试其余资源。

**访问 GET `/users`资源**

![GET Users collection](img/8e44cb40e3c64738882843f3120ed702.jpg)

GET 用户集合

**访问 POST `/users`资源，没有身份验证详细信息**

查看返回的[状态代码 401](http://restfulapi.net/http-status-codes/) 。

![Auth Required for POST APIs](img/7833ce711683a6fec58131e980c6eb5b.jpg)

POST API 所需的认证

**已添加身份验证详细信息的访问 POST `/users`资源**

使用此[链接](http://www.tuxgraphics.org/toolbox/base64-javascript.html)生成 base64 编码的用户名和密码组合，以传递到`Authorization`标头中。

![Request with Auth Details Success](img/ab371e3d282b77709b3f71d0738d0a0a.jpg)

使用认证信息请求成功

将我的问题放在评论部分。

学习愉快！